# 币安量化交易信号生成器

基于币安公共API的高频量化交易信号监控系统，支持BTC/USDT和DOGE/USDT交易对的技术分析和信号生成。

## 🌟 主要功能

- **高频监控**: 5秒间隔实时监控BTC/USDT和DOGE/USDT交易对
- **技术指标**: 支持BOLL(20,2)和KDJ(9,3,3)技术指标计算
- **信号生成**: 3个买入信号 + 4个卖出信号自动检测
- **多种界面**: 命令行、实时监控、详细分析等多种查看方式
- **完整日志**: 所有信号和状态变化的完整记录

## 📋 交易策略详解

### 🎯 BTC/USDT监控条件（市场环境过滤器）
所有DOGE交易必须先满足BTC条件：

**24小时市场条件（满足其一）：**
- 24小时振幅 < 3% **或** 24小时涨幅 > 1%

**KDJ超卖条件（必须同时满足）：**
- 4小时KDJ < **50** 且 1小时KDJ < **50**

### 💎 DOGE/USDT买入信号（多时间框架确认）
**前置条件**：BTC监控条件必须满足

1. **买入信号1（强超卖）**:
   - 1小时：触及下轨(DN) 且 KDJ < 10
   - 15分钟：触及下轨(DN) 且 KDJ < 10
   - 1分钟：KDJ < 20

2. **买入信号2（中等超卖）**:
   - 1小时：触及中轨(MB) 且 KDJ < 15
   - 15分钟：触及下轨(DN) 且 KDJ < 20
   - 1分钟：KDJ < 20

3. **买入信号3（温和超卖）**:
   - 1小时：触及中轨(MB) 且 KDJ < 15
   - 15分钟：触及中轨(MB) 且 KDJ < 20
   - 1分钟：KDJ < 20

### 📈 DOGE/USDT卖出信号（超买平仓）
1. **卖出信号1**: 1h触及UP且KDJ>90, 15m触及MB, 1mKDJ>90
2. **卖出信号2**: 1h触及UP且KDJ>90, 15m触及UP, 1mKDJ>90
3. **卖出信号3**: 1h触及MB且KDJ>90, 15m触及MB, 1mKDJ>90
4. **卖出信号4**: 1h触及MB且KDJ>90, 15m触及UP, 1mKDJ>90

## 🧮 技术指标计算详解

### 📊 24小时振幅计算
```
振幅 = (24小时最高价 - 24小时最低价) / 24小时最低价
示例：高$120,000，低$115,000
振幅 = (120,000 - 115,000) / 115,000 = 4.35%
```

### 📈 布林带(BOLL)指标 - 参数(20,2)
```
中轨(MB) = 收盘价20周期简单移动平均线
标准差(STD) = 收盘价20周期标准差
上轨(UP) = MB + 2 × STD
下轨(DN) = MB - 2 × STD
```

**触及判断（影线法）：**
- 触及上轨：最高价 >= 上轨
- 触及下轨：最低价 <= 下轨
- 接近中轨：|收盘价 - 中轨| <= 中轨 × 0.1%

### 📉 KDJ随机指标 - 参数(9,3,3)
```
1. RSV = (收盘价 - 9期最低价) / (9期最高价 - 9期最低价) × 100
2. K值 = 2/3 × K前值 + 1/3 × RSV （初始值50）
3. D值 = 2/3 × D前值 + 1/3 × K   （初始值50）
4. J值 = 3K - 2D
5. KDJ判断值 = max(K, D, J)
```

**超买超卖判断：**
- 超卖：KDJ < 20（买入时机）
- 中性：20 <= KDJ <= 90
- 超买：KDJ > 90（卖出时机）

### 🔄 策略执行流程
```
1. 获取BTC 24小时数据 → 计算振幅、涨幅
2. 获取BTC 4小时/1小时K线 → 计算KDJ指标
3. 检查BTC条件：(振幅<3% OR 涨幅>1%) AND (4h_KDJ<50 AND 1h_KDJ<50)
4. 如果BTC条件满足：
   ├── 获取DOGE 1小时K线 → 计算BOLL + KDJ
   ├── 获取DOGE 15分钟K线 → 计算BOLL + KDJ
   ├── 获取DOGE 1分钟K线 → 计算KDJ
   └── 多时间框架条件同时满足 → 生成交易信号
```

## 🚀 快速开始

### 1. 环境要求
- Python 3.10+
- 网络连接（访问币安API）

### 2. 安装依赖
```bash
pip install -r requirements.txt
```

### 3. 运行程序

#### 测试模式（推荐首次使用）
```bash
py run.py --test
```

#### 高频监控模式（默认5秒间隔）
```bash
py run.py
```

#### 自定义间隔监控
```bash
py run.py --interval 10
```

#### 实时价格监控
```bash
py simple_monitor.py
```

#### 详细技术分析
```bash
py doge_detail.py
```

## 📁 项目结构

```
binance-quant/
├── src/
│   ├── data/              # 数据获取
│   │   ├── binance_api.py    # REST API封装
│   │   └── websocket_client.py # WebSocket客户端
│   ├── indicators/        # 技术指标
│   │   ├── boll.py           # 布林带计算
│   │   └── kdj.py            # KDJ计算
│   ├── strategy/          # 策略逻辑
│   │   ├── btc_monitor.py    # BTC监控
│   │   └── doge_signals.py   # DOGE信号生成
│   ├── utils/             # 工具模块
│   │   ├── config.py         # 配置管理
│   │   └── logger.py         # 日志系统
│   └── main.py            # 主程序
├── logs/                  # 日志文件
├── config.json           # 配置文件
├── requirements.txt      # 依赖包
├── run.py               # 启动脚本
├── simple_monitor.py     # 简化实时监控
├── doge_detail.py        # DOGE详细分析
├── verify_accuracy.py    # 数据准确性验证
└── README.md            # 项目文档
```

## ⚙️ 配置说明

编辑 `config.json` 文件可以调整系统参数：

```json
{
  "strategy": {
    "btc_conditions": {
      "volatility_threshold": 0.03,  // 振幅阈值 3%
      "growth_threshold": 0.01,      // 涨幅阈值 1%
      "kdj_threshold": 50            // KDJ阈值（实际使用50）
    },
    "doge_thresholds": {
      "oversold": [10, 15, 20, 20],   // 买入信号KDJ阈值
      "overbought": 90                // 卖出信号KDJ阈值
    }
  },
  "indicators": {
    "boll": {
      "period": 20,                   // 布林带周期
      "std_dev": 2                    // 标准差倍数
    },
    "kdj": {
      "k_period": 9,                  // K线周期
      "k_smooth": 3,                  // K值平滑
      "d_smooth": 3                   // D值平滑
    }
  },
  "monitoring": {
    "update_interval": 5,            // 监控间隔（秒）
    "console_output": true           // 控制台输出
  }
}
```

## 📊 使用示例

### 测试模式输出
```
🧪 测试模式运行
✅ API连接成功
📊 BTC条件不满足
💰 DOGE价格: $0.266920 (+0.74%)
当前无信号触发
✅ 测试模式完成
```

### 实时监控输出
```
🚀 交易信号监控启动
监控间隔: 5秒
按 Ctrl+C 停止监控
✅ Binance API连接正常

[22:01:27] BTC计算: 价格$115,687.39, 振幅0.69%, 4hKDJ60.3, 1hKDJ71.1, 条件不满足
[22:01:27] DOGE计算: 价格$0.266460, 1hBOLL触及DN, 1hKDJ49.6, 15mKDJ84.6, 1mKDJ102.8
```

### 信号触发输出
```
🟢 买入信号1触发
🔴 检测到2个卖出信号
🚨 [2024-09-21 14:30:25] Buy Signal 1: DOGEUSDT
🚨 [2024-09-21 15:45:12] Sell Signal 3: DOGEUSDT
```

### 完整监控日志示例
```
📊 BTC条件满足: 振幅2.72%<3%, 4hKDJ45.3<50, 1hKDJ42.1<50
💎 DOGE分析: 1h触及DN(KDJ8.2), 15m触及DN(KDJ7.8), 1m(KDJ18.5)
🟢 买入信号1触发 - 所有条件满足！
```

## 🔧 故障排除

### 常见问题

1. **API连接失败**
   - 检查网络连接
   - 确认防火墙设置
   - 验证币安API服务状态

2. **数据获取失败**
   - 检查网络稳定性
   - 重启程序重试
   - 查看日志文件了解详细错误

3. **信号不触发**
   - 运行测试模式检查系统状态
   - 确认市场条件是否满足策略要求
   - 检查配置参数是否正确

### 日志查看
```bash
tail -f logs/trading_signals.log
```

## ⚠️ 重要声明

- **仅供学习和研究使用**
- **不构成投资建议**
- **请在充分理解策略逻辑后使用**
- **投资有风险，决策需谨慎**

## 🎯 性能特点

### 📈 数据更新频率
- **API调用**: 直接使用币安官方API，与官网数据完全一致
- **监控间隔**: 5秒高频检查，捕获快速市场变化
- **响应速度**: 价格波动几百元内都能及时捕获
- **资源消耗**: 优化的API调用，在安全限制范围内

### 🔒 策略优化
- **市场环境过滤**: BTC条件(KDJ<50)作为大盘环境判断，降低系统性风险
- **多时间框架确认**: 1小时+15分钟+1分钟三重确认，提高信号准确性
- **影线法触及**: 布林带使用影线法判断，更敏感捕捉价格波动
- **振幅计算优化**: 使用最低价作分母，更好反映价格波动幅度
- **实时高频监控**: 5秒间隔实时计算，快速响应市场变化

## 📝 更新日志

### v3.0.0 (2024-09-21) - 当前版本
- 🔧 **修复监控间隔**: 正确使用配置文件5秒间隔设置
- 📈 **优化振幅计算**: 改用最低价作分母，更准确反映波动
- 🎯 **布林带影线法**: 使用影线触及判断，提高信号灵敏度
- 📊 **完善文档**: 详细技术指标计算公式和策略执行流程
- ✅ **实际参数**: BTC KDJ阈值使用50（而非20），与代码一致

### v2.0.0 (2024-09-18)
- 🚀 提升监控频率至5秒间隔
- 🔒 更严格的BTC策略条件
- 📊 新增多种监控界面
- ✅ 完整的数据准确性验证

### v1.0.0 (2024-01-15)
- 初始版本发布
- 支持BTC/USDT和DOGE/USDT监控
- 实现BOLL和KDJ技术指标
- 完整的买卖信号策略
- 命令行界面和日志系统

## 🤝 贡献

欢迎提交Issues和Pull Requests来改进项目。

## 📄 许可证

MIT License